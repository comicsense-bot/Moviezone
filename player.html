<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Watch Movie</title>

<style>
    body {
        background: #000;
        color: white;
        font-family: Arial;
        text-align: center;
        margin: 0;
        padding: 20px;
    }

    .server-buttons {
        margin-top: 15px;
        display: none; /* Hidden because no internal player */
    }

    #adBox {
        position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        background: rgba(0,0,0,0.85);
        display: none;
        justify-content: center;
        align-items: center;
        color: white;
        font-size: 25px;
        flex-direction: column;
    }

    #adBox a {
        color: yellow;
        font-size: 20px;
        margin-top: 10px;
    }

    .external-link-btn {
        margin-top: 30px;
        padding: 12px 25px;
        background: #ff9800;
        border: none;
        border-radius: 10px;
        font-size: 18px;
        cursor: pointer;
        color: #000;
        text-decoration: none;
        display: inline-block;
    }
</style>
</head>

<body>

<h2 id="movieTitle">Loading...</h2>

<!-- External video link button -->
<a id="externalLink" class="external-link-btn" href="#" target="_blank">Watch Now</a>

<h3>Time left: <span id="countdown"></span></h3>

<!-- ⭐ AD POPUP ⭐ -->
<div id="adBox">
    <p>Advertisement</p>
    <a id="adLink" href="#" target="_blank">Click Here</a>
</div>

<!-- ⭐ BUILT-IN MOVIE DATABASE ⭐ -->
<script id="movieDB" type="application/json">
{
  "movies": [
    {
      "id": "movie1",
      "title": "Superman 2025",
      "link": "https://vidsrc.to/embed/movie/1061474",
      "adLink": "https://your-ad-link.com"
    },

    {
      "id": "movie2",
      "title": "Avatar 2: The Way of Water",
      "link": "https://server1.com/avatar2.mp4",
      "adLink": "https://your-ad-link.com"
    }
  ]
}
</script>

<script>
/* ---------------------------
   READ DATABASE FROM HTML
--------------------------- */
const db = JSON.parse(document.getElementById("movieDB").textContent);

/* ---------------------------
   GET MOVIE ID FROM URL
--------------------------- */
const movieID = new URLSearchParams(window.location.search).get("id");
const MOVIE = db.movies.find(m => m.id === movieID);

if (!MOVIE) {
    document.body.innerHTML = "<h1>Movie not found!</h1>";
} else {
    document.getElementById("movieTitle").innerText = MOVIE.title;
    document.getElementById("externalLink").href = MOVIE.link;
    document.getElementById("adLink").href = MOVIE.adLink;
}

/* ---------------------------
   12 HOUR COUNTDOWN
--------------------------- */
let expireKey = "timer_" + movieID;
let expireTime = localStorage.getItem(expireKey);

if (!expireTime) {
    expireTime = Date.now() + 12 * 60 * 60 * 1000; // 12 hours
    localStorage.setItem(expireKey, expireTime);
}

function updateTimer() {
    let now = Date.now();
    let diff = expireTime - now;

    if (diff <= 0) {
        document.body.innerHTML =
          "<h1>Time expired. Return to WordPress to restart.</h1>";
        return;
    }

    let h = Math.floor(diff / 3600000);
    let m = Math.floor((diff % 3600000) / 60000);
    let s = Math.floor((diff % 60000) / 1000);

    document.getElementById("countdown").innerText = `${h}h ${m}m ${s}s`;

    setTimeout(updateTimer, 1000);
}
updateTimer();

/* ---------------------------
   30 MINUTE AD POPUP (5s)
--------------------------- */
setTimeout(() => {
    const ad = document.getElementById("adBox");
    ad.style.display = "flex";

    setTimeout(() => ad.style.display = "none", 5000);
}, 30 * 60 * 1000);
</script>

</body>
</html>